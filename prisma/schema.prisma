// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  password  String
  name      String?
  company   Company? @relation(fields: [companyId], references: [id])
  companyId String?  @db.ObjectId
  forms     Form[]
  createdAt DateTime @default(now())
}

model Company {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  maxUsers  Int?     // limite d'utilisateurs si besoin
  users     User[]
  forms     Form[]
  createdAt DateTime @default(now())
}

model Form {
  id          String       @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String?
  fields      Json         // structure du formulaire (ex: JSON de champs)
  createdBy   User         @relation(fields: [userId], references: [id])
  userId      String       @db.ObjectId
  companyId   String       @db.ObjectId
  submissions Submission[]
  createdAt   DateTime     @default(now())
}

model Submission {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  form      Form     @relation(fields: [formId], references: [id])
  formId    String   @db.ObjectId
  data      Json     // r√©ponses du formulaire
  fileUrls  String[] // URLs S3 des fichiers (images, vocaux, etc.)
  createdAt DateTime @default(now())
}
